---
description: Keeps first N characters of strings or N elements of arrays
sidebar_custom_props:
  customCategory: Text Processing
  customIcon: ‚¨ÖÔ∏è
---

# Keep First

<span className="theme-doc-version-badge badge badge--primary">Text Processing</span><span className="theme-doc-version-badge badge badge--secondary">Data Analysis</span>

## Synopsis

Keeps first N characters of strings or N elements of arrays.

## Schema

```yaml {2-4}
- keep_first:
    field: <ident>
    count: <integer>
    target_field: <string>
    description: <text>
    if: <script>
    ignore_failure: <boolean>
    ignore_missing: <boolean>
    on_failure: <processor[]>
    on_success: <processor[]>
    tag: <string>
```

## Configuration

The following fields are used to define the processor:

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y|-|Source field containing string or array to process|
|`count`|Y|-|Number of characters/elements to keep from the beginning|
|`target_field`|N|Same as `field`|Target field to store result|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|Continue processing if operation fails|
|`ignore_missing`|N|`false`|Skip processing if referenced field doesn't exist|
|`on_failure`|N|-|See <Topic id="handling-failures">Handling Failures</Topic>|
|`on_success`|N|-|See <Topic id="handling-success">Handling Success</Topic>|
|`tag`|N|-|Identifier|

## Details

Extracts the first N characters from string values or the first N elements from array values. This processor is useful for truncating data, creating prefixes, or limiting the size of fields for analysis or display purposes.

The processor handles both string and array data types automatically, applying the appropriate logic based on the input type. For strings, it counts Unicode characters properly, and for arrays, it preserves the original data types of the elements.

:::note
When processing strings, the processor counts Unicode characters correctly, not bytes. This ensures proper handling of international characters and emojis.
:::

If the specified count is greater than the length of the string or array, the processor returns the entire original value without modification.

:::warning
Non-string and non-array values will cause the processor to fail unless `ignore_failure` is set to `true`. The processor cannot determine what "first N" means for other data types.
:::

## Examples

### String Truncation

<ExampleGrid>
  <CommentCol>
    Keeping first 10 characters of a string...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "long_message": "This is a very long message that needs truncation"
    }
    ```
    ```yaml
    - keep_first:
        field: long_message
        count: 10
        target_field: preview
    ```
  </CodeCol>
  <CommentCol>
    creates truncated preview:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "long_message": "This is a very long message that needs truncation",
      "preview": "This is a "
    }
    ```
  </CodeCol>
</ExampleGrid>

### Array Limitation

<ExampleGrid>
  <CommentCol>
    Keeping first 3 elements from an array...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ip_addresses": [
        "192.168.1.1",
        "192.168.1.2", 
        "192.168.1.3",
        "192.168.1.4",
        "192.168.1.5"
      ]
    }
    ```
    ```yaml
    - keep_first:
        field: ip_addresses
        count: 3
        target_field: top_ips
    ```
  </CodeCol>
  <CommentCol>
    keeps only first 3 elements:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ip_addresses": [...],
      "top_ips": [
        "192.168.1.1",
        "192.168.1.2",
        "192.168.1.3"
      ]
    }
    ```
  </CodeCol>
</ExampleGrid>

### In-Place Truncation

<ExampleGrid>
  <CommentCol>
    Truncating field value in place...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_id": "user_1234567890_extended_identifier"
    }
    ```
    ```yaml
    - keep_first:
        field: user_id
        count: 12
    ```
  </CodeCol>
  <CommentCol>
    overwrites original field:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_id": "user_1234567"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Unicode String Handling

<ExampleGrid>
  <CommentCol>
    Properly handling Unicode characters...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "international_text": "H√©llo W√∂rld üòÄ Unicode Text"
    }
    ```
    ```yaml
    - keep_first:
        field: international_text
        count: 8
        target_field: prefix
    ```
  </CodeCol>
  <CommentCol>
    counts Unicode characters correctly:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "international_text": "H√©llo W√∂rld üòÄ Unicode Text",
      "prefix": "H√©llo W√∂"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Conditional Processing

<ExampleGrid>
  <CommentCol>
    Applying truncation based on conditions...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "error_message": "Database connection failed after multiple retry attempts",
      "truncate_errors": true
    }
    ```
    ```yaml
    - keep_first:
        field: error_message
        count: 20
        if: "logEntry.truncate_errors == true"
    ```
  </CodeCol>
  <CommentCol>
    truncates when condition matches:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "error_message": "Database connection ",
      "truncate_errors": true
    }
    ```
  </CodeCol>
</ExampleGrid>