---
description: Removes unused fields
---

# Dot Nester

## Synopsis

```yaml
dot_nester:
  - field: <ident>
  - format: <string>
  - target_field: <ident>
  - delimiter: <string>
  - depth: <numeric>
  - description: <text>
  - if: <script>
  - ignore_failure: <boolean>
  - ignore_missing: <boolean>
  - on_failure: <processor[]>
  - on_success: <processor[]>
  - tag: <string>
```

## Description

**Functionality**: Flattens nested objects into a single-level object where keys are paths representing the original nested structure.

The original nested structure in the source field is preserved when `target_field` is used.

The processor is used for log normalization, schema conversion, and deep object simplification.

:::warning
Only mapped objects are flattened. Non-map values will cause an error unless `ignore_failure` is set to `true`. 
:::

Supports various formats, and can optionally converts field names to match specific schema conventions:

**Default** (no format) - Preserves original field name casing, and uses specified delimiter (defaults to dot notation). Example: `User.FirstName.Last`

**ECS** - Converts all field names to lowercase, and uses specified delimiter (defaults to dot notation). Example: `user.firstname.last`

**CIM** - Converts all field names to lowercase, and is specifically used for Common Information Model. Example: `user.firstname.last`

**ASIM** - Preserves original field name casing, and is specifically used for For Advanced Security Information Model. Example: `User.FirstName.Last`


## Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|N|-|Field containing the nested object to flatten. If empty or omitted, flattens the entire document|
|`format`|N|-|Output format: `ecs`, `cim`, `asim`. When not specified, maintains original case|
|`target_field`|N|`field`|Field to store the flattened result. If not specified, overwrites the source field|
|`delimiter`|N|`.`|Character(s) used to separate nested field names in the flattened result|
|`depth`|N|`-1`|Maximum nesting depth to flatten. Use -1 for unlimited depth|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|If `true`, errors are ignored|
|`ignore_missing`|N|`false`|If `true`, missing fields are skipped|
|`on_failure`|N|-|See [Handling Failures](../handling-failures.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`tag`|N|-|Identifier|

Use `target_field` when you need to preserve the original structure, set appropriate `depth` for controlling nesting levels, and select `delimiter` based on your naming convention.

## Examples

### Documents

<ExampleGrid>
  <CommentCol>
    All nested structures in the document...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user": {
        "name": "John",
        "address": {
          "city": "New York",
          "country": "USA"
        }
      },
      "metadata": {
        "version": "1.0"
      }
    }
    ```
    ```yaml
    dot_nester:
      - target_field: flattened
    ```
  </CodeCol>
  <CommentCol>
    are flattened:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "flattened": {
        "user.name": "John",
        "user.address.city": "New York",
        "user.address.country": "USA",
        "metadata.version": "1.0"
      }
    }
    ```
  </CodeCol>
</ExampleGrid>

### Fields

<ExampleGrid>
  <CommentCol>
    Nested objects...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "nested": {
        "field1": "value1",
        "field2": {
          "subfield": "value2"
        }
      }
    }
    ```
    ```yaml
    flatten:
      - field: nested
      - target_field: flattened
    ```
  </CodeCol>
  <CommentCol>
    are flattened with dot notation:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "nested": {
        "field1": "value1",
        "field2": {
          "subfield": "value2"
        }
      },
      "flattened": {
        "field1": "value1",
        "field2.subfield": "value2"
      }
    }
    ```
  </CodeCol>
</ExampleGrid>

### Delimiter

<ExampleGrid>
  <CommentCol>
    Using underscore as delimiter...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "nested": {
        "field1": "value1",
        "field2": {
          "subfield": "value2"
        }
      }
    }
    ```
    ```yaml
    flatten:
      - field: nested
      - delimiter: "_"
      - target_field: flattened
    ```
  </CodeCol>
  <CommentCol>
    separates paths:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "flattened": {
        "field1": "value1",
        "field2_subfield": "value2"
      }
    }
    ```
  </CodeCol>
</ExampleGrid>

### Depth

<ExampleGrid>
  <CommentCol>
    Limiting the depth...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "root": {
        "level1": {
          "level2": {
            "level3": "deep value"
          },
          "sibling": "value"
        }
      }
    }
    ```
    ```yaml
    flatten:
      - field: root
      - depth: 2
      - target_field: flat
    ```
  </CodeCol>
  <CommentCol>
    flattens only at the specified level:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "flat": {
        "level1.sibling": "value",
        "level1.level2": {
          "level3": "deep value"
        }
      }
    }
    ```
  </CodeCol>
</ExampleGrid>

### Conditions

<ExampleGrid>
  <CommentCol>
    Specific criteria limits flattening...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "source": "external",
      "nested": {
        "field": "value"
      }
    }
    ```
    ```yaml
    flatten:
      - field: nested
      - if: "source == 'external'"
    ```
  </CodeCol>
  <CommentCol>
    only with fields that meet them:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "source": "external",
      "nested": {
        "field": "value"
      }
    }
    ```
  </CodeCol>
</ExampleGrid>

### Formats

<ExampleGrid>
  <CommentCol>
    Using the ECS format...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "User": {
        "Name": "John",
        "Details": {
          "Age": 30
        }
      }
    }
    ```
    ```yaml
    flatten:
      - field: User
      - format: ecs
    ```
  </CodeCol>
  <CommentCol>
    converts field names to lowercase:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "User": {
        "name": "John",
        "details.age": 30
      }
    }
    ```
  </CodeCol>
</ExampleGrid>
