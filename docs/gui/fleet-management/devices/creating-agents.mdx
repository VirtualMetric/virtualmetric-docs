# Creating Agents

Creating **Windows Agents** in DataStream enables local data collection from Windows systems, including event logs, system metrics, and application data. Agents operate as Pull devices, actively collecting data from their host systems and forwarding it to designated directors. This guide covers the complete agent creation and deployment process.

## Windows Agent Overview

Windows Agents are specialized data collection components that:
- **Collect local system data** including Windows event logs, performance metrics, and application logs
- **Forward data** to designated DataStream directors for processing
- **Operate autonomously** once installed and configured
- **Provide secure communication** with directors using encrypted channels

## Agent Creation Process

Windows Agent creation involves a systematic approach to ensure proper deployment and connectivity:

### Step 1: Device Definition and Director Selection

The initial step establishes the foundation for your agent deployment:

- **Name your Windows device** with a descriptive identifier that clearly indicates the target system
- **Select which director** will manage this agent from your available directors
- **Choose Agent deployment type** for local system log collection
- **Ensure the selected director** is active and connected before proceeding
- **Verify network connectivity** between the target system and the selected director

### Step 2: Log Source Configuration

During agent setup, you must configure which log sources the agent will collect from the target system:

#### Predefined Log Source Options
The interface provides common log types including:
- **Security logs** for audit and security monitoring
- **System logs** for operational and error information
- **Application logs** for software-specific events
- **Other standard Windows event log categories**

#### Custom Log Source Configuration
For advanced monitoring requirements, you can specify:
- **Additional event logs** beyond standard categories
- **Performance counters** for system metrics collection
- **Custom log files and sources** for specialized applications
- **Specific event ID filters** and collection rules for targeted monitoring

The custom log selection interface allows detailed specification of monitoring requirements based on your organization's compliance, security, and operational needs.

### Step 3: Creation Confirmation and Next Steps

Successful device creation provides confirmation and guides you through the subsequent steps required for agent installation and configuration.

**Agent Creation Confirmation** displays comprehensive information including:
- **Configuration summary** showing selected log sources and director assignment
- **Next steps** for agent management and monitoring
- **Installation instructions** for deploying the agent on the target system
- **Connection verification** steps to ensure proper operation

## Agent Installation States

The Windows Agent installation process involves several distinct states that help you monitor progress and troubleshoot issues:

### Loading State
During agent installation, the interface displays loading indicators to show installation progress and system activity. This state indicates the agent installation process is actively running.

### Installation Complete, Connection Pending
After successful installation, agents may display "installed but not connected" status while establishing communication with their assigned directors. This is normal and typically resolves within a few minutes as the agent:
- Establishes secure communication channels
- Registers with the assigned director
- Begins initial data collection processes

### Connection Failure
When connection attempts fail, the interface provides:
- **Diagnostic information** about the specific connection issues
- **Troubleshooting guidance** to help resolve connectivity problems
- **Retry options** for attempting reconnection
- **Support resources** for additional assistance

### Connection Success
Successful connections confirm:
- **Agent operational status** and readiness for data collection
- **Communication establishment** with the assigned director
- **Data collection readiness** indicating the agent is fully functional
- **Health indicators** showing ongoing operational status

## Agent Deployment Best Practices

### Planning and Preparation
- **Network Planning**: Ensure network connectivity between agent systems and directors
- **Security Configuration**: Configure appropriate firewall rules for agent communication
- **Resource Assessment**: Verify target systems have adequate resources for agent operation
- **Permission Requirements**: Ensure proper administrative privileges for agent installation

### Naming Conventions
- Use descriptive names that identify the target system and purpose
- Include environment indicators (production, staging, development)
- Maintain consistent naming patterns across your organization
- Consider including location or department information when relevant

### Log Source Selection
- **Start with essential logs**: Begin with security and system logs for baseline monitoring
- **Add application logs** as needed for specific monitoring requirements
- **Consider compliance requirements** when selecting log sources
- **Monitor performance impact** of extensive log collection

### Security Considerations
- **Secure communication**: Agents use encrypted channels for data transmission
- **Access control**: Limit agent installation to authorized personnel
- **Regular updates**: Keep agents updated with latest security patches
- **Monitoring**: Monitor agent status and performance regularly

## Post-Creation Tasks

### Verification Steps
1. **Confirm agent installation** on the target system
2. **Verify director connection** and communication status
3. **Test log collection** by generating test events
4. **Monitor data flow** to ensure proper forwarding to directors

### Ongoing Management
- **Monitor agent health** through the director management interface
- **Review log collection** to ensure all required sources are captured
- **Update configurations** as monitoring requirements change
- **Maintain documentation** of agent deployments and configurations
