# Creating Agents

Creating **Windows Agents** in DataStream enables local data collection from Windows systems, including event logs, system metrics, and application data. Agents operate as Pull devices, actively collecting data from their host systems and forwarding it to designated directors. This guide covers the complete agent creation and deployment process.

## Windows Agent Overview

Windows Agents are specialized data collection components that:
- **Collect local system data** including Windows event logs, performance metrics, and application logs
- **Forward data** to designated DataStream directors for processing
- **Operate autonomously** once installed and configured
- **Provide secure communication** with directors using encrypted channels

## Agent Creation Process

Windows Agent creation involves a systematic approach to ensure proper deployment and connectivity:

### Step 1: Device Definition and Director Selection

The initial step establishes the foundation for your agent deployment:

- **Name your Windows device** with a descriptive identifier that clearly indicates the target system
- **Select which director** will manage this agent from your available directors
- **Choose Agent deployment type** for local system log collection
- **Ensure the selected director** is active and connected before proceeding
- **Verify network connectivity** between the target system and the selected director

### Step 2: Log Source Configuration

During agent setup, you must configure which log sources the agent will collect from the target system:

#### Predefined Log Source Options
The system provides common log types including:
- **Security logs** for audit and security monitoring
- **System logs** for operational and error information
- **Application logs** for software-specific events
- **Other standard Windows event log categories**

#### Custom Log Source Configuration
For advanced monitoring requirements, you can specify:
- **Additional event logs** beyond standard categories
- **Performance counters** for system metrics collection
- **Custom log files and sources** for specialized applications
- **Specific event ID filters** and collection rules for targeted monitoring

The custom log selection process allows detailed specification of monitoring requirements based on your organization's compliance, security, and operational needs.

### Step 3: Creation Confirmation and Next Steps

Successful device creation provides confirmation and guides you through the subsequent steps required for agent installation and configuration.

**Agent Creation Confirmation** displays comprehensive information including:
- **Configuration summary** showing selected log sources and director assignment
- **Next steps** for agent management and monitoring
- **Installation instructions** for deploying the agent on the target system
- **Connection verification** steps to ensure proper operation

## Agent Installation States

The Windows Agent installation process involves several distinct states that help you monitor progress and troubleshoot issues:

### Loading State
During agent installation, the system shows installation progress and system activity. This state indicates the agent installation process is actively running.

### Installation Complete, Connection Pending
After successful installation, agents may display "installed but not connected" status while establishing communication with their assigned directors. This is normal and typically resolves within a few minutes as the agent:
- Establishes secure communication channels
- Registers with the assigned director
- Begins initial data collection processes

### Connection Failure
When connection attempts fail, the system provides:
- **Diagnostic information** about the specific connection issues
- **Troubleshooting guidance** to help resolve connectivity problems
- **Retry options** for attempting reconnection
- **Support resources** for additional assistance

### Connection Success
Successful connections confirm:
- **Agent operational status** and readiness for data collection
- **Communication establishment** with the assigned director
- **Data collection readiness** indicating the agent is fully functional
- **Health indicators** showing ongoing operational status

