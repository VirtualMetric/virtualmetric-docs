---
description: Command-line options
pagination_next: null
---

# Agent

## Overview

**VirtualMetric Agent&trade;** is a lightweight data collection and synchronization component designed to work in distributed environments. It provides agent-based data collection capabilities, cluster synchronization, and management connectivity for enterprise deployments. The agent can operate independently or as part of a larger VirtualMetric infrastructure.

## Synopsis

```bash
vmetric-agent [OPTIONS]
```

## Options

The following command line options are available.

### General Options

|Option|Default|Description|
|--:|:--|---|
|`-compare-version`|-|Compare with specified version|
|`-config`|-|Run configuration wizard|
|`-example`|-|Show usage examples|
|`-path`|-|Specify configuration file or directory path|
|`-read`|-|Read configuration (reserved for future use)|
|`-validate`|-|Validate configuration files|
|`-version`|-|Display version information|

### Mode Options

|Option|Default|Description|
|--:|:--|---|
|`-console`|-|Run in console mode|
|`-mode`|`agent`|Operating mode (`agent`, `supervisor`, `console`, `update`)|
|`-supervisor`|-|Run in supervisor mode|
|`-update`|-|Run update process|

### Service Management

|Option|Default|Description|
|--:|:--|---|
|`-agentless`|-|Run without installing as a service|
|`-background`|-|Run in background mode|
|`-info`|-|Display service information|
|`-service`|-|Service operation (`install`, `uninstall`, `start`, `stop`, `restart`)|
|`-test`|-|Run in test mode|
|`-vpc`|-|Display product code|

### Console Options

|Option|Default|Description|
|--:|:---|---|
|`-debug-level`|-|Set debug verbosity level (1-5)|
|`-filter`|-|Filter console output by keywords|

### Synchronization Options

|Option|Default|Description|
|--:|:--|---|
|`-cluster-sync`|-|Run cluster synchronization with specified interval|
|`-manager-sync`|-|Run manager synchronization with specified interval|

### Control Options

|Option|Default|Description|
|--:|:---|---|
|`-stop`|`false`|Stop running agent process|

## Common Key Combinations

* Press <kb-short>Ctrl+C</kb-short> to terminate and exit the process.
* Press <kb-short>escape</kb-short> to continue execution.

## Operating Modes

### Agent Mode (Default)

The primary operating mode for data collection and processing.

* Basic Usage:

  ```bash
  vmetric-agent
  ```

* Run as Service:

  ```bash
  vmetric-agent -service=install
  vmetric-agent -service=start
  ```

* Run in Background:

  ```bash
  vmetric-agent -background
  ```

* Agentless Mode:

  ```bash
  vmetric-agent -agentless
  ```

### Supervisor Mode

Manages and monitors other VirtualMetric components.

* Basic Usage:

  ```bash
  vmetric-agent -mode=supervisor
  ```

* Supervisor as Service:

  ```bash
  vmetric-agent -mode=supervisor -service=install
  vmetric-agent -mode=supervisor -service=start
  ```

### Console Mode

Interactive mode for monitoring and debugging.

* Basic Console:

  ```bash
  vmetric-agent -mode=console
  ```

* Filtered Console Output:

  ```bash
  vmetric-agent -mode=console -filter="error"
  ```

* Debug Level Console:

  ```bash
  vmetric-agent -mode=console -debug-level=3
  ```

### Update Mode

Handles software updates and maintenance.

* Run Update:

  ```bash
  vmetric-agent -mode=update
  ```

## Service Management

### Installation and Setup

* Install Agent Service:

  ```bash
  vmetric-agent -service=install
  ```

* Install with Custom Path:

  ```bash
  vmetric-agent -path=/custom/config/path -service=install
  ```

* Uninstall Service:

  ```bash
  vmetric-agent -service=uninstall
  ```

### Service Control

* Start Service:

  ```bash
  vmetric-agent -service=start
  ```

* Stop Service:

  ```bash
  vmetric-agent -service=stop
  ```

* Restart Service:

  ```bash
  vmetric-agent -service=restart
  ```

* Check Service Status:

  ```bash
  vmetric-agent -info
  ```

### Process Management

* Stop Running Agent:

  ```bash
  vmetric-agent -stop
  ```

## Configuration Management

### Configuration Wizard

* Run Configuration Setup:

  ```bash
  vmetric-agent -config=setup
  ```

* Configure with Template:

  ```bash
  vmetric-agent -config=template-name
  ```

### Configuration Validation

* Validate Configuration Files:

  ```bash
  vmetric-agent -validate
  ```

* Validate Specific Path:

  ```bash
  vmetric-agent -path=/path/to/config -validate
  ```

## Synchronization Features

### Cluster Synchronization

Synchronizes data and state across cluster nodes.

* Run Cluster Sync (30-second intervals):

  ```bash
  vmetric-agent -cluster-sync=30
  ```

* Run Cluster Sync (5-minute intervals):

  ```bash
  vmetric-agent -cluster-sync=300
  ```

### Manager Synchronization

Synchronizes with central management systems.

* Run Manager Sync (1-minute intervals):

  ```bash
  vmetric-agent -manager-sync=60
  ```

* Run Manager Sync (10-minute intervals):

  ```bash
  vmetric-agent -manager-sync=600
  ```

## Monitoring and Debugging

### Console Monitoring

* Real-time Log Monitoring:

  ```bash
  vmetric-agent -mode=console
  ```

* Filter Specific Events:

  ```bash
  vmetric-agent -mode=console -filter="agent"
  ```

* High-Detail Debug Monitoring:

  ```bash
  vmetric-agent -mode=console -debug-level=5
  ```

### Service Information

* Display Service Details:

  ```bash
  vmetric-agent -info
  ```

* Get Product Code:

  ```bash
  vmetric-agent -vpc
  ```

## Common Usage Patterns

### Basic Deployment

* Standard Agent Installation:

  Install and start the agent service
  
  ```bash
  vmetric-agent -service=install
  vmetric-agent -service=start
  ```

  Verify installation
  
  ```bash
  vmetric-agent -info
  ```

### Development and Testing

* Test Configuration:

  ```bash
  vmetric-agent -validate -path=./test-config.yml
  ```

* Run in Test Mode:

  ```bash
  vmetric-agent -test -agentless
  ```

* Debug with Console:

  ```bash
  vmetric-agent -mode=console -debug-level=4 -filter="test"
  ```

### Distributed Environment Setup

* Primary Agent Node:

  ```bash
  vmetric-agent -service=install
  vmetric-agent -service=start
  ```

* Secondary Agent with Cluster Sync:

  ```bash
  vmetric-agent -agentless -cluster-sync=60
  ```

* Supervisor Node:

  ```bash
  vmetric-agent -mode=supervisor -service=install
  vmetric-agent -mode=supervisor -service=start
  ```

### Maintenance Operations

* Update Agent:

  ```bash
  vmetric-agent -mode=update
  ```

* Graceful Shutdown:

  ```bash
  vmetric-agent -stop
  ```

* Service Restart:

  ```bash
  vmetric-agent -service=stop
  vmetric-agent -service=start
  ```

## Integration Scenarios

### With VirtualMetric Director

* **Agent** with **Director** Coordination:

  Start **Director** first
  
  ```bash
  vmetric-director -service=start
  ```

  Start **Agent** in coordination mode

  ```bash
  vmetric-agent -manager-sync=120
  ```

### Cluster Configuration

* Master **Agent** Node:

  ```bash
  vmetric-agent -service=install
  vmetric-agent -service=start
  ```

* Worker **Agent** Nodes:

  ```bash
  vmetric-agent -agentless -cluster-sync=30 -manager-sync=300
  ```

### High Availability Setup

* Primary **Agent**:

  ```bash
  vmetric-agent -service=install
  vmetric-agent -service=start
  ```

* Backup **Agent**:

  ```bash
  vmetric-agent -mode=supervisor -service=install
  vmetric-agent -mode=supervisor -service=start
  ```

## Troubleshooting

### Service Issues

* Check Service Status:

  ```bash
  vmetric-agent -info
  ```

* Debug Service Problems:

  ```bash
  vmetric-agent -mode=console -debug-level=5
  ```

* Restart Service:

  ```bash
  vmetric-agent -service=stop
  vmetric-agent -service=start
  ```

### Configuration Issues

* Validate Configuration:

  ```bash
  vmetric-agent -validate
  ```

* Reconfigure **Agent**:

  ```bash
  vmetric-agent -config=reset
  ```

### Connectivity Issues

* Test Cluster Communication:

  ```bash
  vmetric-agent -cluster-sync=10 -agentless
  ```

* Debug Manager Connection:

  ```bash
  vmetric-agent -manager-sync=30 -mode=console -debug-level=3
  ```

### Performance Issues

* Monitor **Agent** Performance:

  ```bash
  vmetric-agent -mode=console -filter="performance"
  ```

* Run Performance Test:

  ```bash
  vmetric-agent -test -mode=console
  ```

## Advanced Configuration

### Custom Service Names

When installing with custom configurations:

```bash
vmetric-agent -path=/custom/config -service=install
```

### Background Processing

* Silent Background Operation:

  ```bash
  vmetric-agent -background
  ```

### Multi-Instance Deployment

* Instance 1 (Primary):

  ```bash
  vmetric-agent -service=install
  ```

* Instance 2 (Supervisor):

  ```bash
  vmetric-agent -mode=supervisor -service=install
  ```

## Security Considerations

### Service Permissions

Ensure the agent service runs with appropriate permissions for:

- Network access
- File system access
- Registry access (Windows)
- Process management

### Configuration Security

- Secure configuration files with appropriate file permissions
- Use encrypted communication for cluster synchronization
- Implement access controls for management interfaces

## Version Information

* Check Current Version:

  ```bash
  vmetric-agent -version
  ```

* Compare Versions:

  ```bash
  vmetric-agent -compare-version=2.1.0
  ```

* Show Usage Examples:

  ```bash
  vmetric-agent -example
  ```
