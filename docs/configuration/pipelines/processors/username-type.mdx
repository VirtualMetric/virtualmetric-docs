---
description: Identifies and classifies username formats according to ASIM standards
sidebar_custom_props: 
  customIcon: ðŸ‘¤
  customCategory: Security
---

# Username Type

<span className="theme-doc-version-badge badge badge--primary">Identity Analysis</span><span className="theme-doc-version-badge badge badge--secondary">User Classification</span><span className="theme-doc-version-badge badge badge--secondary">ASIM Compliance</span>

## Synopsis

An identity analysis processor that classifies usernames according to their format type following ASIM (Azure Sentinel Information Model) standards, supporting UPN, Windows, Distinguished Name, and Simple username formats for enhanced security analysis.

## Schema

```yaml {1,2}
- username_type:
  field: <ident>
  target_field: <ident>
  description: <text>
  if: <script>
  ignore_failure: <boolean>
  ignore_missing: <boolean>
  on_failure: <processor[]>
  on_success: <processor[]>
  tag: <string>
```

## Configuration

The following fields are used to define the processor:

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y|-|Field containing the username to classify|
|`target_field`|N|`field`|Field to store the username type|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|Continue if classification fails|
|`ignore_missing`|N|`false`|Continue if source field doesn't exist|
|`on_failure`|N|-|See [Handling Failures](../handling-failures.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`tag`|N|-|Identifier|

## Details

The processor identifies username formats based on structural patterns and assigns appropriate ASIM-compliant type classifications. This enables consistent username analysis across different authentication systems and security platforms.

:::note
The processor follows ASIM standards for username type classification, ensuring compatibility with Azure Sentinel and other SIEM systems.
:::

Username type detection uses pattern matching to identify format characteristics. UPN format contains "@" symbols, Windows format contains backslashes, Distinguished Names contain LDAP components, and Simple format represents basic usernames without special formatting.

The classification helps security analysts understand the authentication context and source system for better threat detection and user behavior analysis.

:::warning
Ensure username fields contain string values for accurate pattern matching and classification.
:::

## Examples

### UPN Format Detection

<ExampleGrid>
  <CommentCol>
    Identifying User Principal Names...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user": "john.doe@company.com",
      "admin_user": "admin@domain.local"
    }
    ```
    ```yaml
    processors:
      - username_type:
        field: user
        target_field: user_type
      - username_type:
        field: admin_user
        target_field: admin_type
    ```
  </CodeCol>
  <CommentCol>
    classifies as UPN format:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user": "john.doe@company.com",
      "admin_user": "admin@domain.local",
      "user_type": "UPN",
      "admin_type": "UPN"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Windows Domain Format

<ExampleGrid>
  <CommentCol>
    Detecting Windows domain usernames...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "logon_user": "DOMAIN\\jsmith",
      "service_account": "COMPANY\\svc-backup"
    }
    ```
    ```yaml
    processors:
      - username_type:
        field: logon_user
        target_field: logon_type
      - username_type:
        field: service_account
        target_field: service_type
    ```
  </CodeCol>
  <CommentCol>
    identifies Windows format:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "logon_user": "DOMAIN\\jsmith",
      "service_account": "COMPANY\\svc-backup",
      "logon_type": "Windows",
      "service_type": "Windows"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Distinguished Name Format

<ExampleGrid>
  <CommentCol>
    Recognizing LDAP Distinguished Names...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ldap_user": "CN=John Smith,OU=Users,DC=company,DC=com",
      "group_dn": "CN=Administrators,OU=Groups,DC=domain,DC=local"
    }
    ```
    ```yaml
    processors:
      - username_type:
        field: ldap_user
        target_field: ldap_type
      - username_type:
        field: group_dn
        target_field: group_type
    ```
  </CodeCol>
  <CommentCol>
    classifies as Distinguished Name:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ldap_user": "CN=John Smith,OU=Users,DC=company,DC=com",
      "group_dn": "CN=Administrators,OU=Groups,DC=domain,DC=local",
      "ldap_type": "DN",
      "group_type": "DN"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Simple Username Format

<ExampleGrid>
  <CommentCol>
    Identifying simple usernames...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "local_user": "administrator",
      "app_user": "api_service",
      "system_user": "root"
    }
    ```
    ```yaml
    processors:
      - username_type:
        field: local_user
        target_field: local_type
      - username_type:
        field: app_user
        target_field: app_type
      - username_type:
        field: system_user
        target_field: system_type
    ```
  </CodeCol>
  <CommentCol>
    classifies as simple format:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "local_user": "administrator",
      "app_user": "api_service",
      "system_user": "root",
      "local_type": "Simple",
      "app_type": "Simple",
      "system_type": "Simple"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Mixed Format Analysis

<ExampleGrid>
  <CommentCol>
    Processing various username formats...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "auth_events": [
        {
          "username": "alice@company.com",
          "source": "Office365"
        },
        {
          "username": "CORP\\bob",
          "source": "ActiveDirectory"
        },
        {
          "username": "guest",
          "source": "Local"
        }
      ]
    }
    ```
    ```yaml
    processors:
      - foreach:
        field: auth_events
        processor:
          username_type:
            field: _ingest._value.username
            target_field: _ingest._value.username_type
    ```
  </CodeCol>
  <CommentCol>
    adds type classification to each event:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "auth_events": [
        {
          "username": "alice@company.com",
          "source": "Office365",
          "username_type": "UPN"
        },
        {
          "username": "CORP\\bob",
          "source": "ActiveDirectory",
          "username_type": "Windows"
        },
        {
          "username": "guest",
          "source": "Local",
          "username_type": "Simple"
        }
      ]
    }
    ```
  </CodeCol>
</ExampleGrid>

### In-Place Classification

<ExampleGrid>
  <CommentCol>
    Replacing username with type classification...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_identity": "CN=Service Account,OU=ServiceAccounts,DC=enterprise,DC=net"
    }
    ```
    ```yaml
    processors:
      - username_type:
        field: user_identity
    ```
  </CodeCol>
  <CommentCol>
    replaces with the detected type:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_identity": "DN"
    }
    ```
  </CodeCol>
</ExampleGrid>
