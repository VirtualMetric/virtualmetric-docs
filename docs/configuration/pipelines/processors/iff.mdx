---
description: Conditional field assignment processor
sidebar_custom_props: 
  customIcon: ‚ùì
  customCategory: Control Flow
---

# IFF

<span className="theme-doc-version-badge badge badge--primary">Logic</span><span className="theme-doc-version-badge badge badge--secondary">Conditional</span>

## Synopsis

A conditional processor that evaluates a condition and assigns different values to a target field based on the result. The processor supports both scalar and array processing, allowing for element-wise conditional operations on arrays.

## Schema

```yaml {2-5}
- iff:
    target_field: <ident>
    condition: <string>
    when_true: <string>
    when_false: <string>
    is_array: <boolean>
    description: <text>
    if: <script>
    ignore_failure: <boolean>
    ignore_missing: <boolean>
    on_failure: <processor[]>
    on_success: <processor[]>
    tag: <string>
```

## Configuration

The following fields are used to define the processor:

|Field|Required|Default|Description|
|---|---|---|---|
|`target_field`|Y|-|Field to store the result|
|`condition`|Y|-|Condition to evaluate (field name or expression)|
|`when_true`|Y|-|Value to assign when condition is true|
|`when_false`|Y|-|Value to assign when condition is false|
|`is_array`|N|`false`|Force array processing mode|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run processor|
|`ignore_failure`|N|`false`|Continue if processor fails|
|`ignore_missing`|N|`false`|Continue if condition field doesn't exist|
|`on_failure`|N|-|See <Topic id="handling-failures">Handling Failures</Topic>|
|`on_success`|N|-|See <Topic id="handling-success">Handling Success</Topic>|
|`tag`|N|-|Identifier|

## Details

The processor evaluates conditions in two ways: as field references or as expressions. When the condition parameter contains a simple field name, it retrieves the field value and evaluates its truthiness. When the condition contains operators (`==`, `!=`, `<`, `>`, `in`), it evaluates the expression directly.

:::note
The processor automatically detects array values and processes them element-wise unless explicitly configured otherwise.
:::

For scalar processing, the processor evaluates the condition once and assigns either `when_true` or `when_false` to the target field. For array processing, it evaluates each array element and creates a result array with corresponding true/false values.

Values can be literal strings, field references, or template expressions using `{{}}` syntax. If a field reference fails, the processor treats the value as a literal string.

:::warning
When processing arrays, mismatched array lengths between condition and value arrays may result in null values for missing elements.
:::

## Examples

### Basic Conditional Assignment

<ExampleGrid>
  <CommentCol>
    Setting status based on score...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "score": 85
    }
    ```
    ```yaml
    - iff:
        target_field: status
        condition: "score >= 70"
        when_true: "pass"
        when_false: "fail"
    ```
  </CodeCol>
  <CommentCol>
    assigns the appropriate status:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "score": 85,
      "status": "pass"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Field Reference Condition

<ExampleGrid>
  <CommentCol>
    Using field truthiness...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "is_premium": true,
      "username": "john_doe"
    }
    ```
    ```yaml
    - iff:
        target_field: access_level
        condition: is_premium
        when_true: "premium"
        when_false: "basic"
    ```
  </CodeCol>
  <CommentCol>
    evaluates field value directly:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "is_premium": true,
      "username": "john_doe",
      "access_level": "premium"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Template Values

<ExampleGrid>
  <CommentCol>
    Using templates in assignments...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_id": 12345,
      "is_admin": false
    }
    ```
    ```yaml
    - iff:
        target_field: greeting
        condition: is_admin
        when_true: "Welcome, Administrator!"
        when_false: "Hello, User {{user_id}}"
    ```
  </CodeCol>
  <CommentCol>
    processes templates in values:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_id": 12345,
      "is_admin": false,
      "greeting": "Hello, User 12345"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Array Processing

<ExampleGrid>
  <CommentCol>
    Processing arrays element-wise...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "scores": [85, 92, 67, 78],
      "threshold": 70
    }
    ```
    ```yaml
    - iff:
        target_field: results
        condition: "scores >= threshold"
        when_true: "PASS"
        when_false: "FAIL"
        is_array: true
    ```
  </CodeCol>
  <CommentCol>
    evaluates each array element:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "scores": [85, 92, 67, 78],
      "threshold": 70,
      "results": ["PASS", "PASS", "FAIL", "PASS"]
    }
    ```
  </CodeCol>
</ExampleGrid>

### Complex Expressions

<ExampleGrid>
  <CommentCol>
    Using complex conditions...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "age": 25,
      "country": "US",
      "has_license": true
    }
    ```
    ```yaml
    - iff:
        target_field: can_rent_car
        condition: "age >= 21 && country == 'US' && has_license"
        when_true: "eligible"
        when_false: "not_eligible"
    ```
  </CodeCol>
  <CommentCol>
    evaluates complex boolean logic:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "age": 25,
      "country": "US",
      "has_license": true,
      "can_rent_car": "eligible"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Array Value Assignment

<ExampleGrid>
  <CommentCol>
    Using arrays as values...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_types": ["admin", "user", "guest"],
      "permissions": ["read", "write", "delete"]
    }
    ```
    ```yaml
    - iff:
        target_field: access_rights
        condition: "user_types == 'admin'"
        when_true: permissions
        when_false: "read"
        is_array: true
    ```
  </CodeCol>
  <CommentCol>
    assigns different values per element:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "user_types": ["admin", "user", "guest"],
      "permissions": ["read", "write", "delete"],
      "access_rights": ["read", "read", "read"]
    }
    ```
  </CodeCol>
</ExampleGrid>
