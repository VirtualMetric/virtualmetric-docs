---
description: Converts DNS query type numbers to human-readable names
sidebar_custom_props: 
  customIcon: üåê
  customCategory: Networking
---

# DNS Query Type

<span className="theme-doc-version-badge badge badge--primary">Enrich</span><span className="theme-doc-version-badge badge badge--secondary">ASIM Compatible</span>

## Synopsis

Converts DNS query type numbers to their corresponding human-readable names using ASIM lookup logic.

## Schema

```yaml {1}
- dns_query_type:
  description: <text>
  field: <ident>
  target_field: <ident>
  if: <script>
  ignore_failure: <boolean>
  ignore_missing: <boolean>
  on_failure: <processor[]>
  on_success: <processor[]>
  tag: <string>
```

## Configuration

The following fields are used to define the processor:

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y||Field containing the DNS query type number|
|`target_field`|N|Same as `field`|Field to store the query type name|
|`description`|N|-|Explanatory notes|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|See [Handling Failures](../handling-failures.mdx)|
|`ignore_missing`|N|`false`|Continue processing if the field is missing|
|`on_failure`|N|-|See [Handling Failures](../handling-failures.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`tag`|N|-|Identifier|

## Details

The processor accepts DNS query type numbers in various formats (string, integer, float) and converts them to standardized DNS record type names according to IANA specifications. It supports all standard DNS record types including:

- **Common types**: A, AAAA, CNAME, MX, NS, PTR, SOA, TXT
- **Security types**: DNSSEC-related records (DS, RRSIG, NSEC, DNSKEY, etc.)
- **Service types**: SRV, NAPTR, URI, CAA
- **Legacy types**: MD, MF, MB, MG, MR (obsolete record types)
- **Query types**: AXFR, IXFR, ANY (zone transfer and special queries)

:::info
This processor follows IANA DNS Parameters specifications and includes support for both standard record types and special query types used in DNS operations.
:::

:::note
Numbers in the Private Use range (65280-65534) are mapped to "Reserved for Private Use", while unrecognized numbers default to "Unassigned".
:::

:::warning
Some DNS record types (like MD, MF, MB) are obsolete and rarely used in modern DNS implementations, but are included for completeness and historical compatibility.
:::

## Examples

### Basic Usage

<ExampleGrid>
  <CommentCol>
    Convert a common DNS query type...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "query_type": 1
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: query_type
    ```
  </CodeCol>
  <CommentCol>
    to its readable name:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "query_type": "A"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Using Target Field

<ExampleGrid>
  <CommentCol>
    Preserve the original number...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "dns_type": 28
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: dns_type
        target_field: dns_type_name
    ```
  </CodeCol>
  <CommentCol>
    while adding the readable name:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "dns_type": 28,
      "dns_type_name": "AAAA"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Mail Exchange Records

<ExampleGrid>
  <CommentCol>
    Mail-related DNS queries...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "record_type": "15"
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: record_type
        target_field: record_name
    ```
  </CodeCol>
  <CommentCol>
    are properly identified:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "record_type": "15",
      "record_name": "MX"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Service Records

<ExampleGrid>
  <CommentCol>
    Service discovery queries...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "query_id": 33
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: query_id
    ```
  </CodeCol>
  <CommentCol>
    show service record types:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "query_id": "SRV"
    }
    ```
  </CodeCol>
</ExampleGrid>

### DNSSEC Records

<ExampleGrid>
  <CommentCol>
    DNSSEC-related queries...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "security_type": 48
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: security_type
        target_field: dnssec_type
    ```
  </CodeCol>
  <CommentCol>
    are identified for security analysis:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "security_type": 48,
      "dnssec_type": "DNSKEY"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Zone Transfer Queries

<ExampleGrid>
  <CommentCol>
    Zone transfer operations...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "transfer_type": 252
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: transfer_type
        target_field: operation_type
    ```
  </CodeCol>
  <CommentCol>
    are flagged as special operations:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "transfer_type": 252,
      "operation_type": "AXFR"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Certificate Authority Records

<ExampleGrid>
  <CommentCol>
    Modern certificate authority records...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "cert_query": 257
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: cert_query
    ```
  </CodeCol>
  <CommentCol>
    are supported for TLS validation:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "cert_query": "CAA"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Private Use Range

<ExampleGrid>
  <CommentCol>
    Numbers in the private use range...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "custom_type": 65300
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: custom_type
        target_field: type_category
    ```
  </CodeCol>
  <CommentCol>
    are identified as private:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "custom_type": 65300,
      "type_category": "Reserved for Private Use"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Unknown Query Types

<ExampleGrid>
  <CommentCol>
    Unrecognized query types...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "unknown_query": 9999
    }
    ```
    ```yaml
    processors:
      - dns_query_type:
        field: unknown_query
    ```
  </CodeCol>
  <CommentCol>
    default to "Unassigned":
  </CommentCol>
  <CodeCol>
    ```json
    {
      "unknown_query": "Unassigned"
    }
    ```
  </CodeCol>
</ExampleGrid>
