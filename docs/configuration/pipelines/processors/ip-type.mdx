---
description: Determines IP address type (IPv4/IPv6) and network classification (Public/Private)
sidebar_custom_props: 
  customIcon: üåç
  customCategory: Networking
---

# IP Type

<span className="theme-doc-version-badge badge badge--primary">Enrich</span><span className="theme-doc-version-badge badge badge--secondary">Network Analysis</span>

## Synopsis

Analyzes IP addresses to determine their type (IPv4 or IPv6) and network classification (Public or Private) based on RFC specifications and reserved address ranges.

## Schema

```yaml {1,3}
- ip_type:
  description: <text>
  field: <ident>
  target_field: <ident>
  if: <script>
  ignore_failure: <boolean>
  ignore_missing: <boolean>
  on_failure: <processor[]>
  on_success: <processor[]>
  tag: <string>
```

## Configuration

The following fields are used to define the processor:

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y||Field containing the IP address to analyze|
|`target_field`|N|Same as `field`|Base field name for storing IP type information|
|`description`|N|-|Explanatory notes|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|See [Handling Failures](../handling-failures.mdx)|
|`ignore_missing`|N|`false`|Continue processing if the field is missing|
|`on_failure`|N|-|See [Handling Failures](../handling-failures.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`tag`|N|-|Identifier|

## Details

The processor analyzes IP addresses and creates two sub-fields containing classification information:

- **`{target_field}.type`**: The IP version type (IPv4, IPv6, or Unknown)
- **`{target_field}.network`**: The network classification (Public, Private, or Unknown)

### IPv4 Classification

For IPv4 addresses, the processor identifies private ranges according to RFC 1918 and other special-use addresses:

- **Private ranges**: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
- **Loopback**: 127.0.0.0/8
- **Link-local**: 169.254.0.0/16
- **Special addresses**: 0.0.0.0/32, 255.255.255.255/32

### IPv6 Classification

For IPv6 addresses, the processor identifies various private and special-use ranges:

- **Loopback**: ::1/128
- **Link-local**: fe80::/64
- **Unique Local Addresses (ULA)**: fc00::/7
- **Site-local (deprecated)**: fec0::/10
- **Multicast**: Various multicast ranges

:::info
This processor follows RFC 1918, RFC 3927, RFC 4193, and other networking standards to accurately classify IP addresses for security analysis and network monitoring.
:::

:::note
The processor automatically handles IPv6 zone identifiers (e.g., `fe80::1%eth0`) by stripping the zone suffix before analysis, ensuring accurate classification.
:::

:::tip
Use IP type classification for security analysis, network segmentation validation, and traffic analysis. Private IP detection is particularly useful for identifying internal vs. external traffic patterns.
:::

## Examples

### Basic IPv4 Public Address

<ExampleGrid>
  <CommentCol>
    Analyze a public IPv4 address...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "client_ip": "8.8.8.8"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: client_ip
    ```
  </CodeCol>
  <CommentCol>
    to determine its classification:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "client_ip": "8.8.8.8",
      "client_ip.type": "IPv4",
      "client_ip.network": "Public"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Private IPv4 Address

<ExampleGrid>
  <CommentCol>
    Identify private network addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "internal_ip": "192.168.1.100"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: internal_ip
        target_field: network_info
    ```
  </CodeCol>
  <CommentCol>
    with custom field names:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "internal_ip": "192.168.1.100",
      "network_info.type": "IPv4",
      "network_info.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>

### IPv6 Public Address

<ExampleGrid>
  <CommentCol>
    Analyze IPv6 addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ipv6_addr": "2001:4860:4860::8888"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: ipv6_addr
    ```
  </CodeCol>
  <CommentCol>
    for version and network type:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ipv6_addr": "2001:4860:4860::8888",
      "ipv6_addr.type": "IPv6",
      "ipv6_addr.network": "Public"
    }
    ```
  </CodeCol>
</ExampleGrid>

### IPv6 Link-Local Address

<ExampleGrid>
  <CommentCol>
    Identify IPv6 link-local addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "local_ipv6": "fe80::1234:5678:9abc:def0"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: local_ipv6
    ```
  </CodeCol>
  <CommentCol>
    as private network addresses:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "local_ipv6": "fe80::1234:5678:9abc:def0",
      "local_ipv6.type": "IPv6",
      "local_ipv6.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Loopback Address Detection

<ExampleGrid>
  <CommentCol>
    Detect loopback addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "localhost": "127.0.0.1"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: localhost
        target_field: loop_info
    ```
  </CodeCol>
  <CommentCol>
    as private network addresses:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "localhost": "127.0.0.1",
      "loop_info.type": "IPv4",
      "loop_info.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>

### IPv6 with Zone Identifier

<ExampleGrid>
  <CommentCol>
    Handle IPv6 zone identifiers...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ipv6_zone": "fe80::1%eth0"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: ipv6_zone
    ```
  </CodeCol>
  <CommentCol>
    by stripping the zone suffix:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ipv6_zone": "fe80::1%eth0",
      "ipv6_zone.type": "IPv6",
      "ipv6_zone.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Multiple IP Analysis

<ExampleGrid>
  <CommentCol>
    Analyze multiple IP addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "source_ip": "10.0.0.1",
      "dest_ip": "203.0.113.1"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: source_ip
      - ip_type:
        field: dest_ip
    ```
  </CodeCol>
  <CommentCol>
    for traffic flow analysis:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "source_ip": "10.0.0.1",
      "dest_ip": "203.0.113.1",
      "source_ip.type": "IPv4",
      "source_ip.network": "Private",
      "dest_ip.type": "IPv4",
      "dest_ip.network": "Public"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Corporate Network Classification

<ExampleGrid>
  <CommentCol>
    Classify corporate network addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "employee_ip": "172.16.10.50"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: employee_ip
        target_field: corp_network
    ```
  </CodeCol>
  <CommentCol>
    for security analysis:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "employee_ip": "172.16.10.50",
      "corp_network.type": "IPv4",
      "corp_network.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>

### Invalid IP Address Handling

<ExampleGrid>
  <CommentCol>
    Handle invalid IP addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "bad_ip": "not.an.ip.address",
      "empty_ip": ""
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: bad_ip
      - ip_type:
        field: empty_ip
        ignore_missing: true
    ```
  </CodeCol>
  <CommentCol>
    with Unknown classification:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "bad_ip": "not.an.ip.address",
      "empty_ip": "",
      "bad_ip.type": "Unknown",
      "bad_ip.network": "Unknown",
      "empty_ip.type": "Unknown",
      "empty_ip.network": "Unknown"
    }
    ```
  </CodeCol>
</ExampleGrid>

### IPv6 Unique Local Address

<ExampleGrid>
  <CommentCol>
    Identify IPv6 Unique Local Addresses...
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ula_address": "fd12:3456:789a:1::1"
    }
    ```
    ```yaml
    processors:
      - ip_type:
        field: ula_address
    ```
  </CodeCol>
  <CommentCol>
    as private network addresses:
  </CommentCol>
  <CodeCol>
    ```json
    {
      "ula_address": "fd12:3456:789a:1::1",
      "ula_address.type": "IPv6",
      "ula_address.network": "Private"
    }
    ```
  </CodeCol>
</ExampleGrid>
