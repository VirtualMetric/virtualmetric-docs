import Synopsis from "@site/src/components/Synopsis";

import Table from '@site/src/components/Table';
import TableRow from '@site/src/components/Table/TableRow';
import TableCell from '@site/src/components/Table/TableCell';

# Set

<Synopsis>
Sets a field and associates it with a specified value.
</Synopsis>

If the field already exists, its value will be replaced with the provided one.

## Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y|N/A|Field to update|
|`copy_from`|N|-|The field whose value will copied to `field`. Cannot be used if `value` is specified. Valid options: `array`, `date`, `boolean`, `number`, `object`, `string`, etc.|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run|
|`ignore_empty_value`|N|`false`|If `true` and `value`/`copy_from` is not `null`, quietly exit if specified field does not exist or its value evaluates to `null` or `empty`|
|`ignore_failure`|N|`false`|See [Handling Failure](../handling-failure.mdx)|
|`media_type`|N|`application/json`|For encoding `value`. Valid options: `application/json`, `text/plain`, or `application/x-www-form-urlencoded`.|
|`on_failure`|N|-|See [Handling Failure](../handling-failure.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`override`|N|`true`|Update non-null fields with `field`. If `false`, do not touch those fields|
|`tag`|N|-|Identifier|
|`value`|N|-|The value to be set. Cannot be used if `copy_from` is specified|

## Examples

* Copying scalar values is straightforward:

<Table>
   <TableBody>
      <TableRow>
         <TableCell>
            Set value of the `foo` field to **1**:
         </TableCell>
         <TableCell>
            ```js
            {
               "set": {
                  "field": "foo",
                  "value": 1
               }
            }
            ```
         </TableCell>
      </TableRow>
   </TableBody>
</Table>

<Table>
   <TableBody>
      <TableRow>
         <TableCell>
            Grab `foo` from `foo.bar` and...
         </TableCell>
         <TableCell>
            ```js
            {
               "processors": [
                  {
                     "set": {
                        "field": "foo.bar",
                        "value": "{{{bar}}}"
                     }
                  }
               ]
            }

            POST _ingest/pipeline/set_os/_simulate
            {
               "docs": [
                  {
                     "_source": {
                        "foo.bar": "BAR"
                     }
                  }
               ]
            }
            ```
         </TableCell>
      </TableRow>
      <TableRow>
         <TableCell>
         ...copy it into `bar`
         </TableCell>
         <TableCell>
            ```js
            {
               "docs": [
                  {
                     "doc": {
                        "_source": {
                           "foo": {
                              "bar": {
                                 "value": "BAR"
                              }
                           }
                        },
                     }
                  }
               ]
            }
            ```
         </TableCell>
      </TableRow>
   </TableBody>
</Table>

* It is possible to access array fields with the dot notation.

<Table>
   <TableBody>
      <TableRow>
         <TableCell>
            The `foo` field contains `bar` with 3 elements:
         </TableCell>
         <TableCell>
            ```js
            POST /_ingest/pipeline/_simulate
            {
               "pipeline": {
                  "processors": [
                     {
                        "set": {
                           "field": "foo",
                           "value": "{{{bar.1}}}"
                        }
                     }
                  ]
               },
               "docs": [
                  {
                     "_source": {
                        "foo": [
                           "A",
                           "B",
                           "C"
                        ]
                     }
                  }
               ]
            }
            ```
         </TableCell>
      </TableRow>
      <TableRow>
         <TableCell>
            We grabbed the **1st** one:
         </TableCell>
         <TableCell>
            ```js
            {
               "docs": [
                  {
                     "doc": {
                        "_source": {
                           "input_field": [
                              "A",
                              "B",
                              "C"
                           ],
                           "bar": "A"
                        },
                     }
                  }
               ]
            }
            ```
         </TableCell>
      </TableRow>
   </TableBody>
</Table>

* The contents of a field including complex values such as arrays or objects can be copied to another field using `copy_from`:

<Table>
   <TableBody>
      <TableRow>
         <TableCell>
            We will copy the valus in `foo`...
         </TableCell>
         <TableCell>
            ```js
            PUT _ingest/pipeline/set_bar
            {
               "processors": [
                  {
                     "set": {
                        "field": "bar",
                        "copy_from": "foo"
                     }
                  }
               ]
            }

            POST _ingest/pipeline/set_bar/_simulate
            {
               "docs": [
                  {
                     "_source": {
                        "foo": ["A", "B"]
                     }
                  }
               ]
            }
            ```
         </TableCell>
      </TableRow>
      <TableRow>
         <TableCell>
            ...into `bar`
         </TableCell>
            ```js
            {
               "docs": [
                  {
                     "doc": {
                        "_source": {
                           "foo": ["A", "B"],
                           "bar": ["A", "B"]
                        },
                     }
                  }
               ]
            }
            ```
      </TableRow>
   </TableBody>
</Table>
