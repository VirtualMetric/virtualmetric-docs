# eStreamer

## Synopsis

```yaml
- id: <numeric>
  name: <string>
  description: <string>
  type: estreamer
  status: <boolean>
  properties:
    address: <string>
    port: <numeric>
    tls:
      status: <boolean>
      cert_name: <string>
      key_name: <string>
      non_secure: <boolean>
    reuse: <boolean>
    workers: <numeric>
    batch_size: <numeric>
    flush_interval: <numeric>
    inputs:
      - id: <numeric>
        status: <boolean>
```

## Description

Creates an eStreamer client that connects to an eStreamer server to receive various security events. Supports TLS encryption, event filtering, and batch processing of events.

## Basic Configuration

The following are the minimum requirements to define the device.

### Device

|Field|Required|Default|Description|
|---|---|---|---|
|`id`|Y||Unique identifier|
|`name`|Y||Device name|
|`description`|N|-|Optional description|
|`type`|Y||Must be `estreamer`|
|`status`|N|`true`|Enable/disable the device|

### Network

|Field|Required|Default|Description|
|---|---|---|---|
|`address`|N|`"0.0.0.0"`|Server address to connect to|
|`port`|N|`8302`|Server port|

### TLS

|Field|Required|Default|Description|
|---|---|---|---|
|`tls.status`|Y|`true`|Enable TLS encryption (always required)|
|`tls.cert_name`|Y||Client certificate file path|
|`tls.key_name`|Y||Client private key file path|
|`tls.non_secure`|N|`false`|Allow less secure TLS versions|

:::note
The client certificate and private key files must be placed in the service root directory.
:::

## Advanced Configuration

To enhance performance and achieve better event handling, the following settings are used.

### Events

The following settings are used for **event processing**:

|Field|Required|Default|Description|
|---|---|---|---|
|`batch_size`|N|`1000`|Number of events to batch before processing|
|`flush_interval`|N|`60`|Event flush interval in seconds|

**Event types** are specified with the following:

|Field|Required|Default|Description|
|---|---|---|---|
|`inputs[].id`|N|-|Event type ID to process|
|`inputs[].status`|N|`true`|Enable/disable specific event type|

The available event types are:

|ID|Description|
|---|---|
|`102`|Connection events|
|`103`|File events|
|`104`|Malware events|
|`106`|Intrusion events|

## Examples

### Basic eStreamer Client

For a basic client, you must:

- enable TLS encryption
- use default event types and settings

<ExampleGrid>
  <CommentCol>
    Create a simple eStreamer client...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 1
      name: estreamer_basic
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
    ```
  </CodeCol>
</ExampleGrid>

### High-Performance Tweaks

For performance tuning, make sure that:

- the batch size is increased
- the flush interval is reduced
- multiple workers are used

<ExampleGrid>
  <CommentCol>
    Optimized for high event volumes...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 2
      name: estreamer_performance
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
        batch_size: 5000
        flush_interval: 30
        reuse: true
        workers: 4
    ```
  </CodeCol>
</ExampleGrid>

### Filtered Event Collection

For selective event processing:

- connection events must be enabled
- intrusion events must be enabled
- file and malware events must be disabled

<ExampleGrid>
  <CommentCol>
    Collect specific event types...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 3
      name: estreamer_filtered
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
        inputs:
          - id: 102
            status: true
          - id: 106
            status: true
    ```
  </CodeCol>
</ExampleGrid>

### Legacy System Support

Compatibility with legacy systems allows:

- use of older TLS versions
- standard event processing
- default security events

<ExampleGrid>
  <CommentCol>
    Connect to older eStreamer servers...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 4
      name: estreamer_legacy
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
          non_secure: true
    ```
  </CodeCol>
</ExampleGrid>

:::warning
For improved security, set `tls.non_secure: false` unless connecting to legacy systems that require older TLS versions.
:::
