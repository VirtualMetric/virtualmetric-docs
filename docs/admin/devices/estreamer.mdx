import BasicConfig from "./_basic-config.mdx";

# eStreamer

## Synopsis

```yaml
- id: <numeric>
  name: <string>
  description: <string>
  type: estreamer
  status: <boolean>
  properties:
    address: <string>
    port: <numeric>
    tls:
      status: <boolean>
      cert_name: <string>
      key_name: <string>
      non_secure: <boolean>
    reuse: <boolean>
    workers: <numeric>
    batch_size: <numeric>
    flush_interval: <numeric>
    inputs:
      - id: <numeric>
        status: <boolean>
```

## Description

Creates an eStreamer client that connects to an eStreamer server to receive various security events. Supports TLS encryption, event filtering, and batch processing of events.

## Basic Configuration

Basic configuration contains properties to define minimum requirements for the device.

### Device Properties

|Field|Required|Default|Description|
|---|---|---|---|
|`id`|Y|-|Unique identifier|
|`name`|Y|-|Device name|
|`description`|N|-|Optional description|
|`type`|Y|-|Must be `estreamer`|
|`status`|N|`true`|Enable/disable the device|

### Network Properties

|Field|Required|Default|Description|
|---|---|---|---|
|`address`|N|`"0.0.0.0"`|Server address to connect to|
|`port`|N|`8302`|Server port|

### TLS Properties

|Field|Required|Default|Description|
|---|---|---|---|
|`tls.status`|Y|`true`|Enable TLS encryption (always required)|
|`tls.cert_name`|Y|-|Client certificate file path|
|`tls.key_name`|Y|-|Client private key file path|
|`tls.non_secure`|N|`false`|Allow less secure TLS versions|

## Advanced Configuration

Advanced configuration contains properties to tune performance and event handling.

### Event Processing

|Field|Required|Default|Description|
|---|---|---|---|
|`batch_size`|N|`1000`|Number of events to batch before processing|
|`flush_interval`|N|`60`|Event flush interval in seconds|

### Event Types

|Field|Required|Default|Description|
|---|---|---|---|
|`inputs[].id`|N|-|Event type ID to process|
|`inputs[].status`|N|`true`|Enable/disable specific event type|

#### Available Event Types

|ID|Description|Default|
|---|---|---|
|`102`|Connection Events|Enabled|
|`103`|File Events|Enabled|
|`104`|Malware Events|Enabled|
|`106`|Intrusion Events|Enabled|

## Examples

### Basic eStreamer Client

<ExampleGrid>
  <CommentCol>
    Create a simple eStreamer client...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 1
      name: estreamer_basic
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
    ```
  </CodeCol>
  <CommentCol>
    Basic configuration:
    - TLS encryption enabled
    - Default event types
    - Default processing settings
  </CommentCol>
</ExampleGrid>

### High-Performance Processing

<ExampleGrid>
  <CommentCol>
    Optimized for high event volumes...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 2
      name: estreamer_performance
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
        batch_size: 5000
        flush_interval: 30
        reuse: true
        workers: 4
    ```
  </CodeCol>
  <CommentCol>
    Performance tuning:
    - Increased batch size
    - Reduced flush interval
    - Multiple workers
  </CommentCol>
</ExampleGrid>

### Filtered Event Collection

<ExampleGrid>
  <CommentCol>
    Collect specific event types...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 3
      name: estreamer_filtered
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
        inputs:
          - id: 102
            status: true
          - id: 106
            status: true
    ```
  </CodeCol>
  <CommentCol>
    Selective event processing:
    - Connection events enabled
    - Intrusion events enabled
    - File and malware events disabled
  </CommentCol>
</ExampleGrid>

### Legacy System Support

<ExampleGrid>
  <CommentCol>
    Connect to older eStreamer servers...
  </CommentCol>
  <CodeCol>
    ```yaml
    - id: 4
      name: estreamer_legacy
      type: estreamer
      properties:
        address: "192.168.1.100"
        port: 8302
        tls:
          cert_name: "client.crt"
          key_name: "client.key"
          non_secure: true
    ```
  </CodeCol>
  <CommentCol>
    Legacy compatibility:
    - Allows older TLS versions
    - Standard event processing
    - Default security events
  </CommentCol>
</ExampleGrid>

:::note
The client certificate and private key files must be placed in the service root directory.
:::

:::warning
For improved security, set `tls.non_secure: false` unless connecting to legacy systems that require older TLS versions.
:::