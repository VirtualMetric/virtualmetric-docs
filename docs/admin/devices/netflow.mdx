# NetFlow

## Synopsis

```yaml
devices:
  - id: <numeric>
    name: <ip-numeric>
    description: <text>
    type: netflow
    status: <logical>
    properties:
      address: <ip-string>
      port: 2055
      reuse: <logical>
      flush_interval: <numeric>
      queue:
        interval: <numeric>
      batch_size: <numeric>
```

## Description

NetFlow is a network protocol developed by Cisco to collect and analyze IP network traffic data. It allows devices such as routers and switches to export detailed flow-level information to a NetFlow collector for monitoring, analysis, and troubleshooting.

NetFlow was the precursor to IPFIX, which is now the industry standard. While NetFlow v9 introduced flexible templates, IPFIX further standardized the approach and added richer features for extensibility.

### Common Versions:

1. **NetFlow v5:**
   - Most widely used version.
   - Fixed fields; no support for IPv6 or flexible data templates.

2. **NetFlow v9:**
   - Template-based format, allowing for extensibility.
   - Supports advanced fields like IPv6, MPLS, and more.

3. **NetFlow Lite:**
   - Lightweight, sampled version for resource-constrained devices.

### Uses of NetFlow Data:

- **Traffic Analysis:**
   - Monitoring bandwidth utilization and understanding traffic patterns.

- **Security Monitoring:**
   - Detecting anomalies, suspicious traffic patterns, or DDoS attacks.
   - Identifying unauthorized access or data exfiltration.

- **Performance Monitoring:**
   - Identifying network congestion or application performance bottlenecks.

- **Capacity Planning:**
   - Long-term trend analysis for future infrastructure upgrades.

- **Compliance Auditing:**
   - Logging flow data for regulatory purposes and forensic investigations.

### Protocol Content

1. **Flow Metadata:**
   - Unique identifiers for network flows, typically defined as packets sharing the same source/destination IP, port, protocol, and ToS.

2. **Traffic Statistics:**
   - Packet and byte counts for each flow.
   - Flow start and end timestamps.

3. **Network Layer Information:**
   - Source and destination IP addresses (IPv4 or IPv6 in NetFlow v9 or IPFIX-based NetFlow).
   - IP protocol type (e.g., TCP, UDP, ICMP).
   - Type of Service (ToS) or Differentiated Services Code Point (DSCP).

4. **Transport Layer Information:**
   - Source and destination port numbers.
   - TCP flags for session state tracking (e.g., SYN, ACK, FIN).

5. **Routing Information:**
   - Input and output interface IDs (as seen by the router).
   - Next-hop IP address.
   - Source and destination Autonomous System (AS) numbers.
   - BGP prefix and community information (if available).

6. **Application Information (Optional in Extended Versions):**
   - Application-layer identification based on traffic patterns (if supported by the device).

7. **Exporter Information:**
   - Details about the device generating the NetFlow data (e.g., router IP address, system uptime).
   - NetFlow version (e.g., v5, v9).

8. **Time Synchronization Data:**
   - Flow timestamps to correlate events accurately.

9. **Additional Extensions (NetFlow v9+):**
   - Support for IPv6, MPLS labels, and multicast traffic.
   - Flexible templates for custom data fields.


## Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`id`|Y|||
|`name`|Y|`127.0.0.1`||
|`description`|N|-||
|`type`|Y|`netflow`||
|`status`||`false`||

## `properties` Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`address`|Y|`"0.0.0.0"`||
|`port`|Y|`2055`||
|`reuse`||`false`||
|`flush_interval`|Y|`1`||
|`queue:interval`|Y|`1`||
|`batch_size`|Y|`1000`||

## Use Cases

<details>
<summary>Sample code</summary>
```yaml
```
</details>

{/* TODO: Complete */}