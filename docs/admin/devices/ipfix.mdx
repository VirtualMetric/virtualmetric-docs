# IPFIX

## Synopsis

```yaml
devices:
  - id: <numeric>
    name: <ip-numeric>
    description: <text>
    type: ipfix
    status: <logical>
    properties:
      address: <ip-string>
      port: 4739
      reuse: <logical>
      flush_interval: <numeric>
      queue:
        interval: <numeric>
      batch_size: <numeric>
```

## Description

Represents the IPFIX protocol.

IPFIX (IP Flow Information Export) is a protocol for exporting network flow information from devices such as routers, switches, and firewalls to a collector for analysis. It is an IETF standard (RFC 7011) and is widely used for network monitoring, performance analysis, security auditing, and anomaly detection.

Uses of IPFIX Data:

- **Traffic Analysis**: Understanding network utilization, bottlenecks, and application performance.
- **Security Monitoring**: Detecting anomalies, DDoS attacks, or unauthorized data exfiltration.
- **Billing and Accounting**: Providing usage-based billing in ISPs or enterprise environments.
- **Capacity Planning**: Long-term trend analysis for infrastructure upgrades.
- **Compliance Auditing**: Logging flow information for regulatory and policy compliance.

IPFIX is often compared to NetFlow, as it expands on NetFlow's functionality with more flexible templates and fields. Let me know if you'd like further details or a comparison with related protocols!

### Protocol Content

<dl>
  <dt>**Flow Metadata**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
     Unique flow identifiers, often based on a combination of source/destination IP, port, protocol, and timestamp
   </dd>

  <dt>**Traffic Statistics**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
      Packet and byte counts for each flow, as well as duration of the flow
   </dd>

  <dt>**Network Layer Information**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - Source and destination IP addresses (IPv4 or IPv6)
    - Differentiated Services Code Point (DSCP) or Type of Service (ToS) values
    </dd>

  <dt>**Transport Layer Information**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - Source and destination port numbers.
    - Protocol type (e.g. `TCP`, `UDP`, `ICMP`)
    </dd>

  <dt>**Application Layer Information**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - Application-level traffic identifiers (if deep packet inspection is enabled)
    - Metadata like HTTP hostnames or URLs (depending on exporter capabilities)
    </dd>

  <dt>**Routing Information**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - Input and output interfaces of the flow
    - Next-hop IP address
    - Autonomous System (AS) numbers for source/destination
    - BGP communities (if applicable)
    </dd>

  <dt>**Security and Accounting Data**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - TCP flags for understanding session states
    - Exporter and flow monitoring timestamps for time synchronization and forensic analysis
    </dd>

  <dt>**User and Host Data (Optional, if integrated)**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - User identities if linked with authentication mechanisms
    - Device or hostname metadata in some cases
    </dd>

  <dt>**Exporter Information**</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
    - Exporter ID or information about the device sending the data
    - Template ID, used to define the structure of flow records
    </dd>

  <dt>**Additional Extensions** (Vendor-Specific)</dt>
    <hr style={{margin: "0px"}}/>
    <dd>
      Allows for vendor-defined templates that extend the standard fields. Examples include NAT translations, DPI data, and security features like IDS/IPS alerts
    </dd>
</dl>

## Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`id`|Y|||
|`name`|Y|`127.0.0.1`||
|`description`|N|-||
|`type`|Y|`ipfix`||
|`status`||`false`||

## `properties` Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`address`|Y|`"0.0.0.0"`||
|`port`|Y|`4739`||
|`reuse`||`false`||
|`flush_interval`||`1`||
|`queue:interval`||`1`||
|`batch_size`||`1000`||

## Use Cases

<details>
<summary>Sample code</summary>
```yaml
```
</details>

{/* TODO: Complete */}