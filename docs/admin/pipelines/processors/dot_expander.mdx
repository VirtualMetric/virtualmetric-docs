# Dot Expander

## Synopsis

```yaml {2}
dot_expander:
   - field: <ident>
   - description: <string>
   - if: <script>
   - ignore_failure: <logical>
   - on_failure: <processors...>
   - on_success: <processors...>
   - path: <string>
   - tag: <string>
```

## Description

**Functionality**: Expands a field containing dots into an object field. Makes fields with dots in their names accessible to other processors.

## Parameters

|Field|Required|Default|Description|
|---|---|---|---|
|`field`|Y|N/foo|Field to be expanded. If set to `*`, all top-level fields will be expanded|
|`description`|N|-|Explanatory note|
|`if`|N|-|Condition to run|
|`ignore_failure`|N|`false`|See [Handling Failures](../handling-failures.mdx)|
|`on_failure`|N|-|See [Handling Failures](../handling-failures.mdx)|
|`on_success`|N|-|See [Handling Success](../handling-success.mdx)|
|`path`|N|-|Field containing the field to expand. Only required when `field` is part of another object field since only leaf level fields can be processed|
|`tag`|N|-|Identifier|

## Examples

<Example>
   <Description>
   If the expanded name is distinct...
   </Description>
   <SampleCode>
      ```yaml
      foo.bar: "v"
      ```
   </SampleCode>
   <Description>
      the part after the dot...
   </Description>
   <SampleCode>
   ```yaml
   dot_expander:
      - field: foo.bar
   ```
   </SampleCode>
   <Description>
   becomes nested:
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar: "v"
   ```
   </SampleCode>
</Example>

<Example>
   <Description>
      If the dotted field clashes with a...
   </Description>
   <SampleCode>
   ```yaml
   foo.bar: "v1"
   foo:
      bar: "v2"
   ```
   </SampleCode>
   <Description>
      nested field...
   </Description>
   <SampleCode>
   ```yaml
   dot_expander:
      field: foo.bar
   ```
   </SampleCode>
   <Description>
      it is merged with it:
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar:
         - "v1"
         - "v2"
   ```
   </SampleCode>
</Example>

<Example>
   <Description>
      In the above case...
   </Description>
   <SampleCode>
   ```yaml
   foo.bar: "v1"
   foo:
      - bar: "v2"
   ```
   </SampleCode>
   <Description>
      using `override` causes the expanded field...
   </Description>
   <SampleCode>
   ```yaml
   dot_expander:
      - field: foo.bar
      - override: true
   ```
   </SampleCode>
   <Description>
      to be overridden by the nested field:
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar: "v2"
   ```
   </SampleCode>
</Example>

<Example>
   <Description>
      With multiple dotted fields...
   </Description>
   <SampleCode>
   ```yaml
   foo.bar: "v1"
   baz.qux: "v2"
   ```
   </SampleCode>
   <Description>
      using `*`...
   </Description>
   <SampleCode>
   ```yaml
   dot_expander:
      - field: "*"
   ```
   </SampleCode>
   <Description>
      expands all top-level ones:
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar: "v1"
   baz:
      - qux: "v2"
   ```
   </SampleCode>
</Example>

<Example>
   <Description>
      If the dotted fields have a common parent...
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar.baz: "v1"
      - bar.qux: "v2"
   ```
   </SampleCode>
   <Description>
       use `path`...
   </Description>
   <SampleCode>
   ```yaml
   dot_expander:
      - path: foo
      - field: "*"
   ```
   </SampleCode>
   <Description>
      to group them as subfields:
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar:
         - baz: "v1"
         - qux: "v2"
   ```
   </SampleCode>
</Example>

<Example>
   <Description>
      If an potential name clash exists...
   </Description>
   <SampleCode>
   ```yaml
   foo: "v1"
   foo.bar: "v2"
   ```
   </SampleCode>
   <Description>
      use `rename` first...
   </Description>
   <SampleCode>
   ```yaml
   processors:
      - rename:
         - field: foo
         - target_field: foo.bar
      - dot_expander:
         - path: foo
         - field: "*"
   ```
   </SampleCode>
   <Description>
     to avoid overwriting a field
   </Description>
   <SampleCode>
   ```yaml
   foo:
      - bar:
         - "v1"
         - "v2"
   ```
   </SampleCode>
</Example>
