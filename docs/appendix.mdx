# Appendix

## Log Format Standards

### ASIM (Advanced Security Information Model)

The Advanced Security Information Model is a layer between the data and the user to configure what and how to ingest data from a source and to route it to a destination. ASIM provides standardization for security-focused log data.

Available ASIM tables:
- `ASimAuditEventLogs`
- `ASimAuthenticationEventLogs` 
- `ASimDhcpEventLogs`
- `ASimDnsActivityLogs`
- `ASimFileEventLogs`
- `ASimNetworkSessionLogs`
- `ASimProcessEventLogs`
- `ASimRegistryEventLogs`
- `ASimUserManagementActivityLogs`

### CEF (Common Event Format)

The Common Event Format is a standardized security event logging layout. Its creator is ArcSight, and it has been widely adopted by the industry. Features include:
- Standard header with 7 required fields
- Extensible key-value pair extension format
- Header fields include: version, device vendor, device product, device version, signature ID, name, and severity
- Extension fields use a key=value format

### CIM (Common Information Model)

The Common Information Model (CIM) is a standardized data model developed by Splunk. It provides:

Common Fields:
| Field Category | Fields | Description |
|---------------|---------|-------------|
| Base Fields | `source`, `sourcetype`, `timestamp`, `host`, `index` | Core fields for event identification and source tracking |
| Identity Fields | `user`, `src_user`, `dest_user` | User identification and authentication tracking |
| Network Fields | `src_ip`, `dest_ip`, `src_port`, `dest_port` | Network communication endpoints |

Data Models:
| Model Type | Fields | Purpose |
|------------|--------|----------|
| Authentication | `action`, `app`, `status`, `auth_method` | Track authentication events and access control |
| Network Traffic | `bytes`, `protocol`, `direction`, `tcp_flags` | Monitor network communications and traffic patterns |
| Vulnerability | `severity`, `signature`, `vulnerability_id` | Track security vulnerabilities and risks |
| Changes | - | Track system and configuration changes |
| Intrusion Detection | - | Monitor security threats and intrusions |

Event Categories:
| Category | Event Types | Description |
|----------|-------------|-------------|
| Authentication | `success`, `failure`, `logout` | Authentication-related events and outcomes |
| Network | `connection`, `alert`, `traffic` | Network activity and communications |
| System | `change`, `status`, `error` | System-level events and status changes |
| Security | - | Security-related events and alerts |

### ECS (Elastic Common Schema)

Elastic Common Schema (ECS) is a specification that defines a common set of fields for ingesting data into Elasticsearch. Field groups include:

| Field Group | Core Fields | Description |
|-------------|-------------|-------------|
| Base Fields | `@timestamp`, `tags`, `labels`, `message` | Universal fields that appear in every event |
| Host | `host.name`, `host.ip`, `host.os.*`, `host.mac` | Information about the host machine |
| Network | `network.protocol`, `network.type`, `network.direction`, `network.bytes` | Network activity details |
| Source/Destination | `source.ip`, `source.port`, `dest.ip`, `dest.port` | Communication endpoint information |
| User | `user.id`, `user.name`, `user.domain`, `user.email` | User-related information |
| Event | `event.category`, `event.type`, `event.action`, `event.outcome` | Event classification details |
| File | `file.path`, `file.size`, `file.type`, `file.hash.*` | File-related information |
| Process | `process.pid`, `process.name`, `process.args`, `process.parent.*` | Process execution details |
| Error | `error.code`, `error.message`, `error.type`, `error.stack_trace` | Error-related information |
| Trace | `trace.id`, `span.id`, `transaction.id` | Distributed tracing data |

### LEEF (Log Event Extended Format)

The Log Event Extended Format is an enterprise security event logging format created by IBM QRadar. Features:
- Lightweight parsing requirements
- Fixed header fields: version, vendor, product, version, eventID
- Variable attributes section
- Optimized for SIEM processing

## Pattern Matching

### Grok Patterns

Common patterns used in log processing:

|Category|Patterns|
|---|---|
|General|`DATA` `GREEDYDATA` `NOTSPACE` `SPACE` `WORD`|
|Numeric|`BASE10NUM` `INT` `NUMBER`|
|Networking|`HOSTNAME` `IP` `IPV4` `IPV6` `MAC`|
|Data and Time|`DATESTAMP` `DATESTAMP_RFC822` `TIMESTAMP_ISO8601`|
|File System|`FILENAME` `PATH`|
|HTTP|`HTTPDATE` `HTTPDERRORLOG` `HTTPDUSER`|
|System|`SYSLOGBASE` `SYSLOGHOST` `SYSLOGTIMESTAMP`|
|Other|`EMAILADDRESS` `URIPARAM` `URIPATH` `UUID`|

### Metadata Tags

Common metadata fields used in log processing:

|Field|Subfields|
|---|---|
|`_ingest`|`on_failure_processor_tag` `on_failure_processor_type`|
|`_temp`|`observer.mac`|
|`destination`|`bytes` `domain` `ip` `nat.port` `port` `user.domain` `name`|
|`email`|`from.address` `to.address`|
|`event`|`category` `kind` `original` `outcome` `type`|
|`source`|`bytes` `ip` `user.domain` `group.name` `id` `xlatesrc`|
|`observer`|`product` `type` `vendor`|
|`related`|`hash` `ip`|

## File Formats

### Parquet Files

Apache Parquet is a column-oriented storage format designed for efficiency:

**Row-based storage** (traditional):
```plaintext
id,name,last_name,age
1,John,Buck,35
2,Jane,Doe,27
3,Joe,Dane,42
```

**Column-based Storage** (Parquet):
```plaintext
id:1,2,3
name:John,Jane,Joe
last_name:Buck,Doe,Dane
age:35,27,42
```

Key features:
- Dictionary encoding
- Compression and bit packing
- Run-length encoding
- Optimized for columnar queries

### PEM Files

Privacy Enhanced Mail (PEM) files are used for storing cryptographic keys and certificates:

```encoding
-----BEGIN CERTIFICATE-----
MIIHzTCCBbWgAwIBAgIQaBYE3/M08XHYCnNVmcFBcjANBgkqhkiG9w0BAQsFADBy
...
-----END CERTIFICATE-----
```

Common uses:
- SSL/TLS certificates
- SSH keys
- RSA private keys
- Certificate chains

File characteristics:
- Base64-encoded content
- Begin/end markers
- Can contain multiple certificates/keys
- Text-based format

## Protocols

### Syslog

Standard protocol for system logging with severity levels:

|Level|Severity|Description|
|---|---|---|
|0|Emergency|System unusable|
|1|Alert|Immediate action required|
|2|Critical|Condition critical|
|3|Error|Errors exist|
|4|Warning|Warnings exist|
|5|Notice|Significant condition|
|6|Info|Info messages|
|7|Debug|Debug messages|

Uses:
- System monitoring
- Security event logging
- Compliance tracking
- Performance monitoring