# Example: Ingesting Data

This section will help you get started with devices to ingest data with specific protocols, walking you through a common use case.

:::tip
For a detailed discussion of devices, see [this section](../../configuration/devices/overview.mdx#configuration).
:::

:::info
To avoid any confusion, delete all YAML files created in other examples. This guarantees that only our current configurations are run.

To execute the code examples, navigate to `<vm_root>`:

<Tabs>
  <TabItem value="powershell" label="PowerShell" default>
    ```powershell
    Set-Location <vm_root>
    ```
  </TabItem>
  <TabItem value="bash" label="Bash">
    ```bash
    cd <vm_root>
    ```
  </TabItem>
</Tabs>

Filenames do not include the path to avoid variation in syntax for different platforms. All configuration files will be placed in our [working directory](./overview.mdx#working-directory).
:::

## Scenario

Use UDP as the listening protocol.

## Setup

We will create a device that will receive data from _Syslog_ using an insecure **UDP** connection.

### Step 1. Create configuration

Create a file named `from-syslog-udp.yml` in our working directory, and then open it with a text editor to enter the following:

```yaml title="from-syslog-udp.yml"
devices:
  - id: 1
    name: from_syslog
    type: syslog
    properties:
      protocol: udp
      address: 0.0.0.0
      port: 514
```

This YAML code specifies that this is a _Syslog_ device, that it will use UDP as its protocol, and that it will be listening on port `514`. You can enter any integer as the `id` value.

However, we also need to define a target that the ingested data willl be directed to, and a route combining the device and the target.

Create a file named `to-console.yml` and add the following target definition to it:

```yaml title="to-console.yml"
targets:
  - name: to_console
    type: console
```

Now create a file named `syslog-to-console.yml` and add the following route definition to it.

```yaml title="syslog-to-console.yml"
routes:
  - name: syslog_to_console
    devices:
      - name: from_syslog
    targets:
      - name: to_console
```

:::tip[info]
To see the ingested data, the stream must be _routed_ to a specific destination, combining the relevant components and orchestrating their flow!

For a detailed discussion, see [Routes: Overview](../../configuration/routes.mdx#configuration).
:::

We are now ready to try our configuration.

### Step 2. Run UDP device

Open a terminal and enter the following in the command line to start **Director**:

<Tabs>
  <TabItem value="powershell" label="PowerShell" default>
    ```powershell
    .\vmetric-director
    ```
  </TabItem>
  <TabItem value="bash" label="Bash">
    ```bash
    ./vmetric-director
    ```
  </TabItem>
</Tabs>

After you press <kb-short>Enter</kb-short>, you will see a stream of initialization messages and our device will be spawned off, waiting to receive _Syslog_ messages.

### Step 3. Test configuration

We can now test the reception using either **Director**'s cross-platform `generator` mode or other traditional tools available on your platform.

Open a new terminal and enter the following in the command line:

<Tabs>
  <TabItem value="powershell" label="PowerShell" default>
    - Using `generator` mode

    ```powershell
    .\vmetric-director -generator -now -mode=syslog -count=1 -address="127.0.0.1:514" -message="Hello world"
    ```
  </TabItem>
  <TabItem value="bash" label="Bash">
    - Using `generator` mode
  
    ```bash
    ./vmetric-director -generator -now -mode=syslog -count=1 -address="127.0.0.1:514" -message="Hello world"
    ```
    
    - Using **System Logger**

    ```bash
    logger -n 127.0.0.1 -P 514 "Hello world"
    ```
  </TabItem>
</Tabs>

If you are using the `generator` mode, after you press <kb-short>Enter</kb-short> the program will start sending our message, one at a time, to _Syslog_. It will signal that it sent the message with a prompt like this:

<Tabs>
  <TabItem value="powershell" label="PowerShell" default>
    ```powershell
    1 message sent successfully in 11 ms with 0 error(s) at 2025-06-02 01:54:02.0349011 +0300 +03 m=+2.821324601
    2 messages sent successfully since 2025-06-02 01:54:00 +0300 +03
    ```
  </TabItem>
  <TabItem value="bash" label="Bash">
    ```bash
    1 message sent successfully in 11 ms with 0 error(s) at 2025-06-02 01:54:02.0349011 +0300 +03 m=+2.821324601
    2 messages sent successfully since 2025-06-02 01:54:00 +0300 +03
    ```
  </TabItem>
</Tabs>

If you now switch back to **Director**'s terminal, you will see each sent message (i.e. "Hello world") on the console:

<Tabs>
  <TabItem value="powershell" label="PowerShell" default>
    ```powershell
    <1> 2025-06-02T08:33:28+03:00 VirtualMetric Test[3872]: Hello world
    ```
  </TabItem>
  <TabItem value="bash" label="Bash">
    ```bash
    <1> 2025-06-02T08:33:28+03:00 VirtualMetric Test[3872]: Hello world
    ```
  </TabItem>
</Tabs>

To exit both of the processes, press <kb-short>Ctrl+C</kb-short> on either terminal.

## Monitoring

Check **Director**'s logs&mdash;the files in the directory indicated [here](./overview.mdx#logging-setup)&mdash;for success messages on launching and initialization, connection acceptance, and configuration validation.

---

In the next section, we will create a secure _device_ to ingest the data.
