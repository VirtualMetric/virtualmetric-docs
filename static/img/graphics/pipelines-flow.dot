digraph pipelinesFlow {
   rankdir=LR
   node [shape=box style=filled fillcolor="#f0f0f0" fontname="Calibri" fontsize=8]

   // Left: Input
   subgraph cluster_input {
      label="Input"
      style="rounded,filled"
      fillcolor="#e3f2fd"
      fontname="Calibri"
      fontsize=8
      event_in [label="Event" shape=box fillcolor="#bbdefb"]
   }

   // Middle: Pipeline with processor categories
   subgraph cluster_pipeline {
      label="Pipeline"
      style="rounded,filled"
      fillcolor="#e8f5e9"
      fontname="Calibri"
      fontsize=8

      // Parse processors
      subgraph cluster_parse {
         label="Parse"
         style="rounded,filled"
         fillcolor="#dcedc8"
         fontname="Calibri"
         fontsize=7
         json [label="JSON" shape=box fillcolor="#c8e6c9"]
         cef [label="CEF" shape=box fillcolor="#c8e6c9"]
      }

      // Transform processors
      subgraph cluster_transform {
         label="Transform"
         style="rounded,filled"
         fillcolor="#dcedc8"
         fontname="Calibri"
         fontsize=7
         rename [label="Rename" shape=box fillcolor="#c8e6c9"]
         set [label="Set" shape=box fillcolor="#c8e6c9"]
      }

      // Enrich processors
      subgraph cluster_enrich {
         label="Enrich"
         style="rounded,filled"
         fillcolor="#dcedc8"
         fontname="Calibri"
         fontsize=7
         geoip [label="GeoIP" shape=box fillcolor="#c8e6c9"]
         lookup [label="Lookup" shape=box fillcolor="#c8e6c9"]
      }

      // Filter processors
      subgraph cluster_filter {
         label="Filter"
         style="rounded,filled"
         fillcolor="#dcedc8"
         fontname="Calibri"
         fontsize=7
         drop [label="Drop" shape=box fillcolor="#c8e6c9"]
         sample [label="Sample" shape=box fillcolor="#c8e6c9"]
      }
   }

   // Right: Output
   subgraph cluster_output {
      label="Output"
      style="rounded,filled"
      fillcolor="#fff3e0"
      fontname="Calibri"
      fontsize=8
      event_out [label="Event" shape=box fillcolor="#ffe0b2"]
   }

   // Flow connections
   event_in -> json
   event_in -> cef
   json -> rename
   cef -> rename
   rename -> set
   set -> geoip
   geoip -> lookup
   lookup -> drop
   lookup -> sample
   drop -> event_out
   sample -> event_out
}
