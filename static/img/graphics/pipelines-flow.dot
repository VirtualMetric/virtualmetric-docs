digraph pipelinesFlow {
   rankdir=LR
   node [shape=box style=filled fillcolor="#f0f0f0" fontname="Calibri" fontsize=8]

   // Invisible input/output nodes for arrows
   event_in [label="" shape=point width=0.1]
   event_out [label="" shape=point width=0.1]

   // Pipeline with processor categories
   subgraph cluster_pipeline {
      label="Pipeline"
      style="rounded,filled"
      fillcolor="#f1f8e9"
      fontname="Calibri"
      fontsize=8

      // Parse processors - pastel blue tones
      subgraph cluster_parse {
         label="Parse"
         style="rounded,filled"
         fillcolor="#e3f2fd"
         fontname="Calibri"
         fontsize=7
         json [label="JSON" shape=box fillcolor="#bbdefb"]
         cef [label="CEF" shape=box fillcolor="#90caf9"]
      }

      // Transform processors - pastel green tones
      subgraph cluster_transform {
         label="Transform"
         style="rounded,filled"
         fillcolor="#e8f5e9"
         fontname="Calibri"
         fontsize=7
         rename [label="Rename" shape=box fillcolor="#c8e6c9"]
         set [label="Set" shape=box fillcolor="#a5d6a7"]
      }

      // Enrich processors - pastel purple tones
      subgraph cluster_enrich {
         label="Enrich"
         style="rounded,filled"
         fillcolor="#f3e5f5"
         fontname="Calibri"
         fontsize=7
         geoip [label="GeoIP" shape=box fillcolor="#e1bee7"]
         lookup [label="Lookup" shape=box fillcolor="#ce93d8"]
      }

      // Filter processors - pastel orange tones
      subgraph cluster_filter {
         label="Filter"
         style="rounded,filled"
         fillcolor="#fff8e1"
         fontname="Calibri"
         fontsize=7
         drop [label="Drop" shape=box fillcolor="#ffe0b2"]
         sample [label="Sample" shape=box fillcolor="#ffcc80"]
      }
   }

   // Flow connections
   event_in -> json
   event_in -> cef
   json -> rename
   cef -> rename
   rename -> set
   set -> geoip
   geoip -> lookup
   lookup -> drop
   lookup -> sample
   drop -> event_out
   sample -> event_out
}
